# =============================================================================
# üåü T√î DE OLHO - Configura√ß√µes de Ambiente
# =============================================================================
# Este arquivo cont√©m todas as vari√°veis de ambiente necess√°rias para o projeto.
# Copie para .env e ajuste os valores conforme necess√°rio.

# =============================================================================
# üß† CONFIGURA√á√ïES INTELIGENTES DE BACKFILL
# =============================================================================
# O sistema decide automaticamente se precisa executar backfill
BACKFILL_START_YEAR=2022
BACKFILL_END_YEAR=0 # Use 0 para considerar automaticamente o ano atual
BACKFILL_BATCH_SIZE=100
BACKFILL_MAX_RETRIES=3
BACKFILL_WORKERS=2
BACKFILL_FORCE=false
# Tempo m√°ximo que o processo que inicia o backfill aguardar√° pela conclus√£o antes de dar timeout
# Formato: time.ParseDuration (ex: "30m", "2h"). Padr√£o: 4h
BACKFILL_MONITOR_TIMEOUT=24h

# Controle de inclus√£o de entidades no backfill hist√≥rico
# Defina como "true" para permitir sincroniza√ß√£o hist√≥rica dessa entidade
BACKFILL_INCLUDE_DESPESAS=true
BACKFILL_INCLUDE_PROPOSICOES=false
BACKFILL_INCLUDE_VOTACOES=true

# Vari√°veis legadas suportadas para compatibilidade (n√£o defina salvo necessidade espec√≠fica)
# INGESTOR_BACKFILL_START_YEAR=2022
# INGESTOR_BATCH_SIZE=100
# INGESTOR_MAX_RETRIES=3

# Controle de execu√ß√£o autom√°tica
BACKFILL_ENABLE_AUTO=true
BACKFILL_CHECK_ON_STARTUP=true

# =============================================================================
# ‚è∞ CONFIGURA√á√ïES INTELIGENTES DO SCHEDULER
# =============================================================================
# Controle autom√°tico de sincroniza√ß√£o incremental
SCHEDULER_ENABLE_DAILY=true
SCHEDULER_DAILY_INTERVAL_HOURS=20
SCHEDULER_QUICK_INTERVAL_HOURS=3

# Express√µes CRON para agendamento
SCHEDULER_DAILY_CRON=0 2 * * *
SCHEDULER_QUICK_CRON=0 */3 * * *

# Controle de entidades a sincronizar
SCHEDULER_INCLUDE_DEPUTADOS=true
SCHEDULER_INCLUDE_PROPOSICOES=true
SCHEDULER_INCLUDE_DESPESAS=true
SCHEDULER_INCLUDE_VOTACOES=true

# Controle de inclus√£o fino via vari√°veis de ambiente (opt-in para reduzir volume)
# Ao definir uma dessas vari√°veis para "true", o scheduler/backfill executar√° a entidade correspondente.
# Se n√£o definido ou diferente de "true", o processamento ser√° pulado.
# SCHEDULER_INCLUDE_PROPOSICOES=false
# SCHEDULER_INCLUDE_VOTACOES=true

# Configura√ß√µes de sincroniza√ß√£o
SCHEDULER_BATCH_SIZE=100
SCHEDULER_MAX_CONCURRENT=5
SCHEDULER_TIMEOUT=30m
SCHEDULER_PARALLEL_WORKERS=3

# =============================================================================
# üöÄ CONFIGURA√á√ïES DO SERVIDOR
# =============================================================================
PORT=8080
GIN_MODE=release
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_SHUTDOWN_TIMEOUT=10s

# =============================================================================
# üóÑÔ∏è CONFIGURA√á√ïES DO BANCO DE DADOS (PostgreSQL)
# =============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=to_de_olho
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres123
POSTGRES_SSL_MODE=disable

# Pool de conex√µes
POSTGRES_MAX_CONNS=25
POSTGRES_MIN_CONNS=5
POSTGRES_MAX_CONN_LIFETIME=1h
POSTGRES_MAX_CONN_IDLE_TIME=30m

# =============================================================================
# üöÄ CONFIGURA√á√ïES DO CACHE (Redis)
# =============================================================================
REDIS_ADDR=redis:6379
REDIS_PASSWORD=
REDIS_DB=0

# Timeouts
REDIS_READ_TIMEOUT=500ms
REDIS_WRITE_TIMEOUT=500ms
REDIS_DIAL_TIMEOUT=500ms

# Pool de conex√µes
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=5
REDIS_MAX_CONN_AGE=30m

# Cache TTL (Time To Live)
CACHE_TTL_DEPUTADOS=1h
CACHE_TTL_PROPOSICOES=30m
CACHE_TTL_DESPESAS=15m
CACHE_TTL_VOTACOES=5m

# Cache multilevel
CACHE_ENABLE_L1=true
CACHE_ENABLE_L2=true
CACHE_L1_SIZE=1000
CACHE_L2_SIZE=10000

# =============================================================================
# üèõÔ∏è CONFIGURA√á√ïES DA API DA C√ÇMARA DOS DEPUTADOS
# =============================================================================
CAMARA_API_BASE_URL=https://dadosabertos.camara.leg.br/api/v2
CAMARA_CLIENT_TIMEOUT=60s

# Rate Limiting (respeitar limites da API)
CAMARA_CLIENT_RPS=4
CAMARA_CLIENT_BURST=8

# Retry e Circuit Breaker
CAMARA_CLIENT_MAX_RETRIES=2
CAMARA_CLIENT_RETRY_DELAY=500ms
CAMARA_CLIENT_BACKOFF_MULTIPLIER=2.0

# Configura√ß√µes de resili√™ncia
CAMARA_CLIENT_CIRCUIT_BREAKER_THRESHOLD=5
CAMARA_CLIENT_CIRCUIT_BREAKER_TIMEOUT=60s

# =============================================================================
# ‚è±Ô∏è CONFIGURA√á√ïES DE TIMEOUT E RESILI√äNCIA
# =============================================================================
# HTTP Timeouts (tempo m√°ximo para requisi√ß√µes)
HTTP_REQUEST_TIMEOUT=30s
HTTP_CLIENT_TIMEOUT=45s

# Circuit Breaker Timeouts (AJUSTADO: API da C√¢mara pode demorar 15-30s)
# ANTES: 10s (causava timeouts frequentes)
# DEPOIS: 45s (alinhado com HTTP_CLIENT_TIMEOUT)
CIRCUIT_BREAKER_RESET_TIMEOUT=60s
CIRCUIT_BREAKER_OP_TIMEOUT=45s

# Database Timeouts
DATABASE_TIMEOUT=15s
DATABASE_CONNECT_TIMEOUT=5s

# Cache Timeouts (Redis)
CACHE_READ_TIMEOUT=500ms
CACHE_WRITE_TIMEOUT=1s
CACHE_DEFAULT_TTL=5m

# Rate Limiting
API_RATE_LIMIT_PER_SECOND=2
API_BURST_LIMIT=5

# Retry Policy
RETRY_DELAY=5s
MAX_RETRY_ATTEMPTS=3
BACKOFF_MULTIPLIER=2.0

# Headers personalizados
CAMARA_CLIENT_USER_AGENT=TodeOlho/1.0

# =============================================================================
# üéØ CONFIGURA√á√ïES DA APLICA√á√ÉO
# =============================================================================
APP_ENV=development
LOG_LEVEL=info
APP_VERSION=1.0.0

# Configura√ß√µes de seguran√ßa
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=24h
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080

# Rate Limiting da API
API_RATE_LIMIT_RPS=100
API_RATE_LIMIT_BURST=200

# Configura√ß√µes de monitoramento
METRICS_ENABLE=true
HEALTH_CHECK_INTERVAL=30s

# =============================================================================
# üåê CONFIGURA√á√ïES DO FRONTEND (Next.js)
# =============================================================================
# IMPORTANTE: NEXT_PUBLIC_* s√£o injetadas no browser, n√£o no servidor!
NEXT_PUBLIC_API_URL=http://localhost:8080/api/v1
NEXT_PUBLIC_APP_NAME=T√¥ De Olho
NEXT_PUBLIC_APP_VERSION=1.0.0

# Configura√ß√µes de autentica√ß√£o (NextAuth.js)
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-super-secret-nextauth-key-change-in-production

# Analytics e tracking
NEXT_PUBLIC_ANALYTICS_ID=
NEXT_PUBLIC_TRACKING_ENABLED=false

# =============================================================================
# üõ†Ô∏è CONFIGURA√á√ïES DE DESENVOLVIMENTO
# =============================================================================
# Apenas para desenvolvimento local
NODE_ENV=development

# =============================================================================
# üöÄ CONFIGURA√á√ïES DE DEPLOY E CI/CD
# =============================================================================
# Para ambientes de produ√ß√£o/staging
# DATABASE_URL=postgresql://user:pass@host:port/dbname?sslmode=require
# REDIS_URL=redis://user:pass@host:port/db

# Configura√ß√µes de deploy
DEPLOY_ENV=local
DEPLOY_VERSION=1.0.0

# Docker e containers
DOCKER_REGISTRY=
DOCKER_TAG=latest

# Configura√ß√µes de ambiente
ENVIRONMENT_NAME=development
DEBUG_MODE=true

# =============================================================================
# üìä CONFIGURA√á√ïES DE MONITORAMENTO E OBSERVABILIDADE
# =============================================================================
# Prometheus metrics
PROMETHEUS_ENABLE=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your-secure-grafana-password-here

# Logging estruturado
LOG_FORMAT=json
LOG_OUTPUT=stdout
LOG_FILE_PATH=/var/log/to-de-olho.log

# =============================================================================
# üîí CONFIGURA√á√ïES DE SEGURAN√áA
# =============================================================================
# Chaves de criptografia
ENCRYPTION_KEY=your-32-char-encryption-key-here!
HASH_SALT=your-unique-salt-for-hashing

# Configura√ß√µes SSL/TLS
TLS_CERT_PATH=/certs/server.crt
TLS_KEY_PATH=/certs/server.key
TLS_ENABLE=false

# Headers de seguran√ßa
SECURITY_HEADERS_ENABLE=true
CSP_POLICY="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'"
